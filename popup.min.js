function getImagesInfo(){const images=document.querySelectorAll("img"),imagesInfo=[];return images.forEach((image=>{const info={src:image.src,width:image.naturalWidth,height:image.naturalHeight,title:image.title,alt:image.alt};imagesInfo.push(info)})),imagesInfo}function getImageWeight(image){return fetch(image.src).then((response=>response.blob())).then((blob=>{const weight=blob.size;return{...image,weight:weight}})).catch((error=>(console.error("Error fetching image:",error),{...image,weight:0})))}chrome.tabs.query({active:!0,currentWindow:!0},(function(tabs){chrome.scripting.executeScript({target:{tabId:tabs[0].id},function:getImagesInfo},(function(results){if(chrome.runtime.lastError)return void console.error("Error executing script:",chrome.runtime.lastError.message);const imagesInfo=results[0]?.result||[],imageInfoElement=document.getElementById("imageInfo");if(0===imagesInfo.length)imageInfoElement.innerHTML="<p>No images found on this page.</p>";else{const imageWeightPromises=imagesInfo.map((image=>getImageWeight(image)));Promise.all(imageWeightPromises).then((imagesWithWeight=>{imagesWithWeight.forEach((image=>{const stack=`\n          \n<div class="mb-4">\n            \n  <div class="relative">\n             \n    <img src="${image.src}" class="mb-2" width="auto" height="auto" alt="${image.alt}" title="${image.title}" style="border: 1px solid ${image.alt||image.title?"#888":"red"}; cursor: pointer;">\n \n  <div class="absolute inset-0 flex items-center justify-center opacity-0 transition-opacity duration-300 hover:opacity-100">\n                \n  <a href="${image.src}" download>\n\n    <i class="fas fa-download text-white text-lg bg-gray-800 p-2 rounded-full text-white-500 bg-blue-500"></i>\n\n  </a>\n\n  </div>\n \n  </div>\n\n  <p><strong>Dimensions:</strong> ${image.width} x ${image.height}</p>\n\n  <p><strong>Alt:</strong> ${image.alt?image.alt:'<span style="color: red;">Missing</span>'}</p>\n\n   <p><strong>Title:</strong> ${image.title?image.title:'<span style="color: red;">Missing</span>'}</p>\n\n  <p><strong>Weight:</strong> ${(image.weight/1024).toFixed(2)} KB</p>\n</div>\n`;imageInfoElement.innerHTML+=stack}));const totalImageWeightKB=imagesWithWeight.reduce(((sum,image)=>sum+image.weight),0)/1024,headerElement=document.getElementById("total_image_weight"),totalWeightElement=document.createElement("p");totalWeightElement.innerHTML=`Total Images Weight:<strong> ${totalImageWeightKB.toFixed(2)} KB</strong>`,headerElement.appendChild(totalWeightElement)})).catch((error=>{console.error("Error calculating total image weight :",error)}))}}))}));